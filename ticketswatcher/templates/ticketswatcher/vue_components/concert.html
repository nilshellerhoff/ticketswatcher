<template id="templateConcert">
    <a :href="`/concert/${concert.pk}`" class="text-decoration-none">
        <li class="list-group-item d-flex justify-content-between align-items-start">
            <div class="ms-2 me-auto">
                [[ concert.fields.provider_title ]]
                <div class="fw-bold">[[ concert.fields.title ]]</div>
                <span style="font-size: 14px">
                    <i class="bi bi-clock-fill"></i> [[ formattedDate ]]<br>
                    <i class="bi bi-geo-alt-fill"></i> [[ concert.fields.venue ]]
                </span>
            </div>
            <span :class="`badge ${availablePill.color} rounded-pill`">[[ availablePill.label ]]</span>
        </li>
    </a>
</template>

<script>
    Vue.component('concert', {
        delimiters: ['[[', ']]'],
        template: '#templateConcert',
        props: ['concert'],
        computed: {
            availablePill() {
                const avail = this.concert.fields.available_tickets
                if (avail >= 20) return {label: '20+', color: 'bg-success'}
                else if (avail > 0) return {label: avail, color: 'bg-warning'}
                else if (avail !== null) return {label: avail, color: 'bg-danger'}
                else return {label: '--', color: 'bg-secondary'}
            },
            formattedDate() {
                const datetime = new Date(this.concert.fields.datetime)
                const dateOptions = {weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric'}
                return datetime.toLocaleString('de-DE', dateOptions)
            }
        }
    });
</script>